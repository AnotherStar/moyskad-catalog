# moyskad-catalog

Генератор ICML для каталога из МойСклад

## Использование

1) Выполните include файла `MoySkladICMLParser.php`

2) Сконфигурируйте парсер

```php
$parser = new MoySkladICMLParser(
    'login@moysklad',
    'password',
    'shopname',
    $options
);
```

3) Вызовите метод `generateICML`

```php
$parser->generateICML();
```

Смотрите файл `example.php` в качестве простого примера использования парсера.

## Дополнительные опции

Параметр $options - массив со следующими ключами:

* `file` - Имя файла с итоговым icml без пути (по умолчанию: shopname.catalog.xml)
* `directory` - Директория для итогового icml файла (по умолчанию: текущая директория)
* `ignoreOffers` - Если `true` модификации товаров из МойСклад будут проигнорированы
* `ignoreCategories` - Строка `'all'` или массив с ключами:
  * `uuids` - Массив c `uuid` групп товаров, которые должны быть проигнорированы
  * `externalCodes` - Массив c `внешними кодами` групп товаров, которые должны быть проигнорированы
* `ignoreProducts` - Массив с ключами:
  * `uuids` - Массив с `uuid` товаров, которые будут проигнорированы (Модификации товара проигнорировать нельзя)
  * `externalCodes` - Массив с `внешними кодами` товаров, которые будут проигнорированы (Модификации товара проигнорировать нельзя)

Все доступные опции не обязательны для использования

## Добавление пользовательских полей url и picture

Для того чтобы добавить в выгрузку изображение товара либо url требуется создать 2 пользовательских поля к товару в моем складе

1) Заходим в Администрирование<br>
2) Выбираем вкладку справочники<br>
3) Затем выбрать справочник Товар<br>
4) Добавить нужное пользовательское поле<br>

Параметры пользовательского поля для URL
* `Название` - RetailCrmURL
* `Тип` - Строка

Параметры пользовательского поля для пути к изображению
* `Название` - RetailCrmPicture
* `Тип` - Строка

![settings](https://raw.githubusercontent.com/dmamontov/moyskad-catalog/master/doc/settings/settings.png)